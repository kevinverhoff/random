---
title: "4Leaf Solar"
output: html_document
date: "2025-09-04"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Total taxes

```{r}
library(scales)
library(dplyr)
total = 2400000
df = data.frame(categories = c('ðŸŽ“ Education\n$1.2 Million','ðŸŽ“ Education\n$1.2 Million','âš–ï¸ Local Government\n$800 Thousand','â›‘ï¸ Public Safety\n$400 Thousand'),
                recipients = c('Cloverdale\nCommunity Schools','South Putnam\nCommunity Schools','Putnam County','Greencastle\nFire Department'),
                amounts = c((1/3)*total,(1/6)*total,(1/3)*total,(1/6)*total)
                )

df = df %>%
  arrange(desc(categories)) %>%
  mutate(ypos = (cumsum(amounts) - amounts / 2),
         amounts_label = dollar(amounts),
         x_label = 1.9,
         angle = 360 * (ypos / sum(amounts)),
         hjust = ifelse(angle > 180, 1, 0))
df
```

```{r}
library(ggplot2)
color_map <- c(
  "ðŸŽ“ Education\n$1.2 Million" = "#679436",
  "âš–ï¸ Local Government\n$800 Thousand" = "#bbe5ed",
  "â›‘ï¸ Public Safety\n$400 Thousand" = "#db5461")


# Plot donut chart
p <- ggplot(df, aes(x = 2, y = amounts, fill = categories)) +
  geom_bar(stat = "identity", width = 1, color = "white") +
  geom_text(
    data = df,
    aes(x = 2.5, y = ypos, label = paste0(recipients, ":\n", amounts_label,0), hjust=hjust), 
    color = "gray25", fontface = "bold", size = 4
  ) +
  coord_polar(theta = "y", start = 0, clip="off") +
  scale_fill_manual(values = color_map) +
  xlim(0.5, 2.5) +
  theme_minimal(base_size = 12) +
  labs(
    title = "4 Leaf Solar Community Payments",
    subtitle = "Annual Additional Revenue 4 Leaf Solar will Generate for Putnam County",
    fill = NULL
  ) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, face = "italic"),
    legend.position = "bottom",
    legend.text = element_text(hjust = 0.5),
    legend.justification = "center",
    panel.grid = element_blank(),
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    plot.title.position = "plot",
    plot.subtitle.position = "plot",
    plot.margin = margin(1, 1, 1, 1, "cm")
  ) +
  annotate("text", x = 0.5, y = 0, label = paste0("$2.4\nMillion"), size = 8, fontface = "bold", color="#2e3532")
  
p
```

